(.venv) root@akos-sch:~/uni-projects/bdm2# make exploitation-multidim
Running pipeline for multidimensional exploitation zone...
source .venv/bin/activate
python -m src.exploitation.multidimensional
:: loading settings :: url = jar:file:/root/uni-projects/bdm2/.venv/lib/python3.10/site-packages/pyspark/jars/ivy-2.5.1.jar!/org/apache/ivy/core/settings/ivysettings.xml
Ivy Default Cache set to: /root/.ivy2/cache
The jars for the packages stored in: /root/.ivy2/jars
org.apache.spark#spark-avro_2.12 added as a dependency
org.mongodb.spark#mongo-spark-connector_2.12 added as a dependency
org.postgresql#postgresql added as a dependency
:: resolving dependencies :: org.apache.spark#spark-submit-parent-dfc41ebf-a42a-4333-a22a-0fbcb6669ee5;1.0
        confs: [default]
        found org.apache.spark#spark-avro_2.12;3.5.1 in central
        found org.tukaani#xz;1.9 in central
        found org.mongodb.spark#mongo-spark-connector_2.12;10.3.0 in central
        found org.mongodb#mongodb-driver-sync;4.8.2 in central
        [4.8.2] org.mongodb#mongodb-driver-sync;[4.8.1,4.8.99)
        found org.mongodb#bson;4.8.2 in central
        found org.mongodb#mongodb-driver-core;4.8.2 in central
        found org.mongodb#bson-record-codec;4.8.2 in central
        found org.postgresql#postgresql;42.2.23 in central
        found org.checkerframework#checker-qual;3.5.0 in central
:: resolution report :: resolve 1383ms :: artifacts dl 9ms
        :: modules in use:
        org.apache.spark#spark-avro_2.12;3.5.1 from central in [default]
        org.checkerframework#checker-qual;3.5.0 from central in [default]
        org.mongodb#bson;4.8.2 from central in [default]
        org.mongodb#bson-record-codec;4.8.2 from central in [default]
        org.mongodb#mongodb-driver-core;4.8.2 from central in [default]
        org.mongodb#mongodb-driver-sync;4.8.2 from central in [default]
        org.mongodb.spark#mongo-spark-connector_2.12;10.3.0 from central in [default]
        org.postgresql#postgresql;42.2.23 from central in [default]
        org.tukaani#xz;1.9 from central in [default]
        ---------------------------------------------------------------------
        |                  |            modules            ||   artifacts   |
        |       conf       | number| search|dwnlded|evicted|| number|dwnlded|
        ---------------------------------------------------------------------
        |      default     |   9   |   1   |   0   |   0   ||   9   |   0   |
        ---------------------------------------------------------------------
:: retrieving :: org.apache.spark#spark-submit-parent-dfc41ebf-a42a-4333-a22a-0fbcb6669ee5
        confs: [default]
        0 artifacts copied, 9 already retrieved (0kB/6ms)
Setting default log level to "ERROR".
To adjust logging level use sc.setLogLevel(newLevel). For SparkR, use setLogLevel(newLevel).
2024-05-30 20:48:09,578 - multidimensional - INFO - Python version = 3.10
2024-05-30 20:48:09,578 - multidimensional - INFO - Spark version = 3.5.1
2024-05-30 20:48:09,579 - multidimensional - INFO - Removing all rows from tables if they exist
2024-05-30 20:48:09,693 - multidimensional - INFO - Creating tables if they do not exist
2024-05-30 20:48:09,701 - multidimensional - INFO - Reading data from MongoDB
2024-05-30 20:48:12,546 - multidimensional - INFO - Loading location dimension table with 73 rows
2024-05-30 20:48:17,046 - multidimensional - INFO - Loading year dimension table with 17 rows
2024-05-30 20:48:18,708 - multidimensional - INFO - Loading month dimension table with 57 rows
2024-05-30 20:48:20,036 - multidimensional - INFO - Loading day dimension table with 129 rows
2024-05-30 20:48:21,371 - multidimensional - INFO - Loading income fact table with 803 rows
2024-05-30 20:48:21,885 - multidimensional - INFO - First lookup: looking up neighborhood_id for idealista with location_lookup
2024-05-30 20:48:22,588 - multidimensional - INFO - Out of 7855 listings in Barcelona, 3382 listings have non-reconciled neighborhoods
2024-05-30 20:48:22,633 - multidimensional - INFO - Second lookup: looking up neighborhood_id for idealista with idealista_resolved_location_lookup
2024-05-30 20:48:23,949 - multidimensional - INFO - There are 7855 listings in Barcelona, out of which 0 listings have non-reconciled neighborhoods after the second lookup
2024-05-30 20:48:24,867 - multidimensional - INFO - Loading idealista fact table with 7855 rows